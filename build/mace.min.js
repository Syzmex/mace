"use strict";(function(){var e={},t=e.global=this;e.version="0.0.1";var n=Array.prototype,i=Object.prototype,r=Function.prototype,o=n.push,a=n.slice,c=i.toString,s=i.hasOwnProperty,u=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],l=!{toString:null}.propertyIsEnumerable("toString");+function(){var t=function(t,n){return function(i,r,o){var c=0,s=i.length;if("number"==typeof o&&(t>0?c=o>=0?o:Math.max(o+s,c):s=o>=0?Math.min(o+1,s):o+s+1),r!==r)return o=n(a.call(i,c,s),e.isNaN),o>=0?o+c:-1;for(o=t>0?c:s-1;o>=0&&s>o;o+=t)if(i[o]===r)return o;return-1}},n=function(e){return function(t,n){for(var i=t.length,r=e>0?0:i-1;r>=0&&i>r;r+=e)if(n(t[r],r,t))return r;return-1}},i=n(1),r=n(-1);e.indexOf=t(1,i),e.lastIndexOf=t(-1,r)}(),e.uidcounter_=0,e._uid_="uid_"+(1e9*Math.random()>>>0),e.getUid=function(t){return t[e._uid_]||(t[e._uid_]=++e.uidcounter_)},e.hasUid=function(t){return!!t[e._uid_]},e.removeUid=function(t){"removeAttribute"in t&&t.removeAttribute(e._uid_);try{delete t[e._uid_]}catch(n){}},e.cloneObject=function(t){var n=e.typeOf(t);if("object"==n||"array"==n){if(t.clone)return t.clone();var i,r,o=e.keys(t),a="array"==n?[]:{};for(i=0,r=o.length;r>i;i++)a[o[i]]=e.cloneObject(t[o[i]]);return a}return t},e.pick=function(t,n){var i={};return e.isArray(n)||(n=[n]),e.each(n,function(e){i[e]=t[e]}),i},e.extend=function(e){var t,n,i,r,o,a;if(i=arguments.length,2>i||null==e)return e;for(t=1;i>t;t++){a=arguments[t];for(o in a)e[o]=a[o];if(l)for(r=u.length,n=0;r>n;n++)o=u[n],s.call(a,o)&&(e[o]=a[o])}return e},e.extendOwn=function(e){var t,n,i,r,o,a;if(i=arguments.length,2>i||null==e)return e;for(t=1;i>t;t++){a=arguments[t];for(o in a)s.call(a,o)&&(e[o]=a[o]);if(l)for(r=u.length,n=0;r>n;n++)o=u[n],s.call(a,o)&&(e[o]=a[o])}return e},e.typeOf=function(e){var t=typeof e,n=c.call(e);if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof String)return"string";if(e instanceof Object)return t;if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t},e.isDef=function(e){return void 0!==e},e.isNull=function(e){return null===e},e.isNaN=function(e){return e!==e},e.isDefAndNotNull=function(e){return null!=e},e.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},e.isDateLike=function(t){return e.isObject(t)&&"function"==typeof t.getFullYear},e.isBoolean=function(e){return"boolean"==typeof e},e.isNumberAndNotNaN=function(e){return"number"==typeof e&&e==e},e.isArray=n.isArray||function(t){return"array"==e.typeOf(t)},e.isArrayLike=function(t){return e.isArray(t)||e.isObject(t)&&"number"==typeof t.length},e.isString=function(e){return"[object String]"===c.call(e)},+function(){var t=function(t,n){for(var i,r=[],o=u.length;o--;)i=u[o],s.call(t,i)&&!~e.indexOf(n,i)&&r.push(i);return r};e.isEmpty=function(n){if(null==n)return!0;if(e.isArrayLike(n)&&(e.isArray(n)||e.isString(n)||e.isArguments(n)))return 0===n.length;var i,r;for(i in n)return!1;return l?(r=t(n,[]),0===r.length):!0},e.keys=function(n){if(!e.isObject(n))return[];if(Object.keys)return Object.keys(n);var i,r=[];for(i in n)e.has(n,i)&&r.push(i);return l&&r.concat(t(n,r)),r}}(),e.has=function(e,t){return null!=e&&s.call(e,t)},e.each=function(t,i,r){var o,a,c;if(e.isArray(t)||e.isArrayLike(t))if(n.forEach)n.forEach.call(t,i,r);else for(c=e.isString(t)?t.split(""):t,o=0,a=t.length;a>o;o++)i.call(r,c[o],o,t);else for(c=e.keys(t),o=0,a=c.length;a>o;o++)i.call(r,t[c[o]],c[o],t)},e.filter=function(t,n){var i=[];return e.each(t,function(e,t,r){n(e,t,r)&&i.push(e)}),i},+function(){var t=function(e){return e.call.apply(e.bind,arguments)},i=function(e,t){if(arguments.length>2){var i=n.slice.call(arguments,2);return function(){var r=n.slice.call(arguments);return n.unshift.apply(r,i),e.apply(t,r)}}return function(){return e.apply(t,arguments)}};e.bind=function(n){if(!n)throw new Error("Can't find any function");return e.bind=r.bind&&-1!=r.bind.toString().indexOf("native code")?t:i,e.bind.apply(null,arguments)}}(),e.partial=function(e){var t=n.slice.call(arguments,1);return function(){var n=t.slice();return o.apply(n,arguments),e.apply(this,n)}},e.each(["Arguments","Function","Number","Date","RegExp","Error"],function(t){e["is"+t]=function(e){return c.call(e)==="[object "+t+"]"}}),+function(){e.isArguments(arguments)||(e.isArguments=function(t){return e.has(t,"callee")});var n=!!t.execScript||function(){return t.eval("var _et_ = 1"),void 0!=t._et_?(delete t._et_,!0):!1}();e.globalEval=function(e){if(t.execScript)t.execScript(e,"JavaScript");else{if(!t.eval)throw Error("globalEval not available");if(n)t.eval(e);else if(doc){var i=doc.createElement("script");i.type="text/javascript",i.defer=!1,i.appendChild(doc.createTextNode(e)),doc.body.appendChild(i),doc.body.removeChild(i)}}}}(),+function(){var t=function(){this.__init__&&this.__init__.apply(this,arguments)};t.prototype.destroy=function(){this.destroyInternal(),e.each(this,function(t,n){e.has(this,n)&&(this[n]=null)},this),this.isDisposed=!0},t.prototype.destroyInternal=function(){if(this.internalCallbacks_)for(;this.internalCallbacks_.length;)this.internalCallbacks_.shift()()},t.prototype.addInternalCallbacks=function(t){e.isFunction(t)?this.internalCallbacks_?this.internalCallbacks_.push(t):this.internalCallbacks_=[t]:new Error("Can't find function")};var n=function(t,n){var i,r=this;i=t&&e.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)};var o=function(){this.constructor=i};o.prototype=r.prototype,i.prototype=new o,t.__init__||(t.__init__=function(){e.isFunction(r.prototype.__init__)&&r.prototype.__init__.apply(this,arguments),e.isFunction(t.init)&&t.init.apply(this,arguments)});var a=t.destroy;return t.destroy=function(){e.isFunction(a)&&a.apply(this,arguments),e.isFunction(r.prototype.destroy)&&r.prototype.destroy.apply(this,arguments)},e.extend(i.prototype,t),e.isFunction(n)?(e.extend(i,r),n(i)):e.extend(i,r,n),i.__super__=r.prototype,i.super_=function(e,t){var n,i,o=[];for(n=2,i=arguments.length;i>n;n++)o[n-2]=arguments[n];return r.prototype[t].apply(e,o)},i};t.extend=n,t.include=function(t){e.extend(this.prototype,t)},e.createClass=function(i,r,o){return e.isFunction(i)&&i.extend===n?i.extend(r,o):(o=r,r=i,t.extend(r,o||{}))}}(),+function(){var t={init:function(){this.length=0,this.__hash__=0,this.__cache__={},this.__contents__={}},child:function(t){if(this.has(t))return this.get(t);var n=new e.Dictionary;return this.put(t,n),n},put:function(e,t){if(this.has(e))for(var n in this.__cache__)this.__cache__[n]===e&&(this.__contents__[n]=t);else this.__cache__[this.__hash__]=e,this.__contents__[this.__hash__++]=t,this.length++;return this},get:function(e){for(var t in this.__cache__)if(this.__cache__[t]===e)return this.__contents__[t];return null},has:function(e){for(var t in this.__cache__)if(this.__cache__[t]===e)return!0;return!1},remove:function(e){if(this.has(e))for(var t in this.__cache__)this.__cache__[t]===e&&(delete this.__cache__[t],delete this.__contents__[t],this.length--);return this}},n={version:"0.0.1"};e.Cache=e.Dictionary=e.createClass(t,n)}(),+function(){var t={init:function(t){this.type,this.currentType,e.extendOwn(this,t),this.isImmediatePropagationStopped=!1},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=!0}};e.Event=e.createClass(t);var n=/\s+/,i=/:/,r=/^change:\S*$/,o={},c=function(e,t){var n,r=t.split(i)[1];Object.defineProperty(e,r,{set:function(e){n!==e&&this.trigger(t,n=e)},get:function(){return n},enumerable:!0})},s=function(e,t,n,i,o,a){var s,u,l,_=void 0!==o?o:a?a.listener:t,f=e[n]||(e[n]=[]);for(s=0,u=f.length;u>s;s++)if(void 0!==o){if(f[s].callback===i&&f[s].context===o)return e;if(i.__clb__&&f[s].callback.__clb__===i.__clb__&&f[s].context===o)return e}else{if(f[s].callback===i)return e;if(i.__clb__&&f[s].callback.__clb__===i.__clb__)return e}return l={obj:t,context:_,callback:i},a&&(a.count++,l.listener=a.listener),r.test(n)&&c(t,n),f.push(l),e},u=function(t,n,i,r,o,a){if(a){var c=0,s=a.listener;e.each(i?[i]:e.keys(t),function(n){var i=t[n],a=i.length;i=e.filter(i,function(e){if(e.listener===s){if(r&&e.callback.__clb__)return void 0===o?e.callback.__clb__!==r:e.context!==o||e.callback.__clb__!==r;if(r)return void 0===o?e.callback!==r:e.context!==o||e.callback!==r}return!0}),c+=a-i.length,i.length?t[n]=i:delete t[n]}),a.count-=c}else r?e.each(i?[i]:e.keys(t),function(n){var i=t[n];i=e.filter(i,function(e){return e.callback.__clb__?void 0===o?e.callback.__clb__!==r:e.context!==o||e.callback.__clb__!==r:void 0===o?e.callback!==r:e.context!==o||e.callback!==r}),i.length?t[n]=i:delete t[n]}):i?delete t[i]:t={};return t},l=function(t,n,i,r,a){if(i){var c=e.getUid(t),u=o[c],l=t.__events__||(t.__events__={});if(t.__events__=s(l,t,n,i,r,a),u||(o[c]=t),a){var _=t.__listeners__||(t.__listeners__={}),f=_[a.id];f||(_[a.id]=a)}}},_=function(t,n,i,r,a){var c=e.getUid(t),s=t.__events__;if(s&&(s=u(s,t,n,i,r,a)),s&&e.isEmpty(s)?(delete t.__events__,delete o[c]):t.__events__=s,a){var l=a.listener,_=t.__listeners__,f=l.__listenTo__;0===a.count&&(delete _[a.id],delete f[a.objId]),e.isEmpty(_)&&delete t.__listeners__,e.isEmpty(f)&&delete l.__listenTo__}},f=function(t,i,r,o,a,c){if(e.isObject(r)){var s,u,l,_=e.isArray(r)?r:e.keys(r);for(s=0,u=_.length;u>s;s++)f(t,i,l=_[s],r[l],o,c)}else r&&n.test(r)?e.each(r.split(n),function(e){e&&t(i,e,o,a,c)}):t(i,r,o,a,c)},h=function(t,n,i,r,o){i&&e.isObject(n)&&(r=i,i=void 0),f(l,t,n,i,r,o)},p=function(t,n,i,r,o){if(e.isObject(n)){var a,c,s,u=e.keys(n);for(a=0,c=u.length;c>a;a++)p(t,s=u[a],n[s],i,o)}var l=function(){i.apply(this,arguments),t.off(n,l,r)};l.__clb__=i,h(t,n,l,r,o)},d=function(t,n,i,r,o){e.isFunction(n)?(r=i,i=n,n=void 0):n&&i&&!e.isFunction(i)&&!e.isFunction(n)&&(r=i,i=void 0),f(_,t,n,i,r,o)},v=function(t,i,r,o){var a=t.__events__;e.each(i.split(n),function(n){n&&!~e.indexOf(t.__silenceStack__,n)&&y(t,a,n,r,o)})},y=function(t,n,i,r,o){var a,c=n[i],s=n.all;c&&(o&&(a=new e.Event({type:i,currentType:i,target:t,data:r})),m(c,a?[a].concat(r):r)),s&&"all"!==i&&(o&&(a=new e.Event({type:i,currentType:"all",target:t,data:r})),m(s,a?[a].concat(r):r))},m=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3];switch(t.length){case 1:return void g(e,n);case 2:return void g(e,n,i);case 3:return void g(e,n,i,r);case 4:return void g(e,n,i,r,o);default:return void b(e,t)}},g=function(e,t,n,i,r){for(var o,a,c=!1,s=t,u=-1,l=e.length;++u<l&&!c;)a=e[u],a.obj.__eventhandle__?(o=a.obj.__eventhandle__[s.type].__fireAll__,(o||s.fired&&void 0==s.usecapture||s.usecapture===a.context)&&a.callback.call(a.obj.element,t,n,i,r)):a.callback.call(a.context,t,n,i,r),c=s&&s.isImmediatePropagationStopped},b=function(e,t){for(var n,i,r=!1,o=t[0],a=-1,c=e.length;++a<c&&!r;)i=e[a],i.obj.__eventhandle__?(n=i.obj.__eventhandle__[o.type].__fireAll__,(n||o.fired&&void 0==o.usecapture||o.usecapture===i.context)&&i.callback.apply(i.obj.element,t)):i.callback.apply(i.context,t),r=o&&o.isImmediatePropagationStopped},E=function(t,n,i,r,o){var a=e.getUid(this),c=e.getUid(n),s=this.__listenTo__||(this.__listenTo__={}),u=s[c];u||(u=s[c]={obj:n,objId:c,listener:this,id:a,count:0}),t(n,i,r,o,u)},k={init:function(){e.getUid(this),this.__silence__=!1,this.__silenceStack__=[]},destroy:function(){e.removeUid(this),e.Evented.super_(this,"destroy")},silence:function(t){return t?(e.isArray(t)||(t=a.call(arguments)),void e.each(t,function(t){~e.indexOf(this.__silenceStack__,t)||this.__silenceStack__.push(t)})):this.__silence__=!0},desilence:function(t){return t?(e.isArray(t)||(t=[t]),void(this.__silenceStack__=e.filter(this.__silenceStack__,function(n){return!~e.indexOf(t,n)}))):this.__silence__=!1},on:function(e,t,n){return e&&h(this,e,t,n),this},once:function(e,t,n){return e&&p(this,e,t,n),this},off:function(e,t,n){return e&&this.__events__&&d(this,e,t,n),this},trigger:function(t){if(!this.__silence__&&t&&this.__events__){var n,i=a.call(arguments,1);e.isObject(t)&&t.type&&(n=t,t=[n.type],i.unshift(n),this.__wantEvent__=!1,n.isImmediatePropagationStopped=!1),v(this,t,i,this.__wantEvent__!==!1)}return this},listenTo:function(e,t,n,i){return e&&E.call(this,h,e,t,n,i),this},listenToOnce:function(e,t,n,i){return e&&E.call(this,p,e,t,n,i),this},stopListen:function(t,n,i,r){if(t&&this.__listenTo__){var o,a,c,s=this.__listenTo__,u=t?[e.getUid(t)]:e.keys(this.__listenTo__);for(o=0,a=u.length;a>o&&(c=s[u[o]],c);o++)d(c.obj,n,i,r,c)}return this}},x={version:"0.0.1",eventpool:o,getObject:function(e){return o[e]}};e.Object=e.Evented=e.createClass(k,x)}(),+function(t){var n=t.navigator,i=t.document,r=n.userAgent.toLowerCase(),o=i.documentElement,a="ActiveXObject"in t,c=-1!==r.indexOf("firefox"),s=-1!==r.indexOf("webkit"),u=-1!==r.indexOf("phantom"),l=-1!==r.search("android [23]"),_=-1!==r.indexOf("chrome"),f=-1!==r.indexOf("gecko")&&!s&&!t.opera&&!a,h="undefined"!=typeof orientation||-1!==r.indexOf("mobile"),p=!t.PointerEvent&&t.MSPointerEvent,d=t.PointerEvent&&n.pointerEnabled||p,v=a&&"transition"in o.style,y="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!l,m="MozPerspective"in o.style,g="OTransition"in o.style,b=["focusin","focusout","mouseenter","mouseleave","input"],E="svg"===o.nodeName.toLowerCase(),k=!u&&(d||"ontouchstart"in t||t.DocumentTouch&&i instanceof t.DocumentTouch),x=function(){return"function"!=typeof i.createElement?i.createElement(arguments[0]):E?i.createElementNS.call(i,"http://www.w3.org/2000/svg",arguments[0]):i.createElement.apply(i,arguments)},w=function(){var e=!("onblur"in i.documentElement);return function(t,n){var i;return t?(n&&"string"!=typeof n||(n=x(n||"div")),t="on"+t,i=t in n,!i&&e&&(n.setAttribute||(n=x("div")),n.setAttribute(t,""),i="function"==typeof n[t],void 0!==n[t]&&(n[t]=void 0),n.removeAttribute(t)),i):!1}}();e.support={ie:a,ielt9:a&&!i.addEventListener,firefox:c,webkit:s,gecko:f,android:-1!==r.indexOf("android"),android23:l,chrome:_,safari:!_&&-1!==r.indexOf("safari"),ie3d:v,webkit3d:y,gecko3d:m,opera12:g,any3d:(v||y||m)&&!g&&!u,mobile:h,mobileWebkit:h&&s,mobileWebkit3d:h&&y,mobileOpera:h&&t.opera,mobileGecko:h&&f,touch:!!k,msPointer:!!p,pointer:!!d,retina:(t.devicePixelRatio||t.screen.deviceXDPI/t.screen.logicalXDPI)>1},e.each(b,function(t){e.support[t]=w(t)})}(t),+function(){var t={getWindow:function(e){return e?this.getDocument(e).defaultView:window},getDocument:function(e){return e&&e.ownerDocument||document},contains:function(e,t){if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));if(e.contains)return e!==t&&e.contains(t);for(;t=t.parentNode;)if(e==t)return!0;return!1},parent:function(e){return e.parentNode},parents:function(e,t,n){var i,r,o,a=[],c=this.parent(e);return n&&(i=this.getDocument(e),r=i.defaultView||window,o=t?[r,i]:[i,r]),c==i?o||[]:(c&&(a=t?this.parents(c,t,n).concat([c]):[c].concat(this.parents(c,t,n))),a)}};e.dom=t}(),+function(){var n=/\s+/,i=(e.support.ielt9,!!t.document.addEventListener),r={},o=new e.Dictionary,c="type target returnValue defaultPrevented currentTarget eventPhase timeStamp cancelable cancelBubble bubbles isTrusted".split(" "),s=c.concat("isChar detail layerX layerY pageX pageY view which".split(" ")),u=s.push("relatedTarget"),l=s.concat("altKey button clientX clientY ctrlKey metaKey movementX movementY offsetX offsetY relatedTarget screenX screenY shiftKey fromElement toElement webkitForce x y".split(" ")),_=s.concat("altGraphKey altKey charCode ctrlKey keyCode keyIdentifier keyLocation location metaKey shiftKey".split(" ")),f=function(e,t,n,i){e.addEventListener?e.addEventListener(t,n,i):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},h=function(e,t,n,i){e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null},p=function(t,n,i,o){this.__eventhandle__||(this.__eventhandle__={});var a=this,c=r[n],s=n+":"+o,u=n+":"+!o,l=(this.__events__[n],this.__eventhandle__[n]||(this.__eventhandle__[n]={}));l[s]||(l[s]=function(t){if(l[u]&&l.__fireAll__)return void delete l.__fireAll__;l[u]&&t.target!==this||(l.__fireAll__=!0);var i=c&&c.fix?c.fix(y(t)):y(t);i.usecapture=o,e.DomEvented.super_(a,"trigger",n,i)},c&&c.on?c.on(t,n,l[s],o):f(t,n,l[s],o))},d=function(t,n,i,o){var a,c,s,u=this.__eventhandle__,l=u&&u[n];l&&(s=r[n]||{},c=this.__events__&&this.__events__[n],a=void 0===o?[n+":false",n+":true"]:[n+":"+o],e.each(a,function(i,r){var a=void 0===o?!!r:o,u=e.filter(c,function(e){return e.context===a});u.length||(s.off?s.off(t,n,l[i],a):h(t,n,l[i],a),delete l[i])})),!l||l[n+":false"]||l[n+":true"]||delete this.__eventhandle__[n],u&&e.isEmpty(u)&&delete this.__eventhandle__},v=function(t,i,r,o,a){if(e.isObject(r)){var c,s,u,l=e.isArray(r)?r:e.keys(r);for(c=0,s=l.length;s>c;c++)v(t,i,u=l[c],r[u],a)}else r&&n.test(r)?e.each(r.split(n),function(e){e&&t(i,e,o,a)}):t(i,r,o,a)},y=function(n){var i,r,o=c;return t.MouseEvent&&n instanceof t.MouseEvent?o=l:t.FocusEvent&&n instanceof t.FocusEvent?o=u:t.KeyboardEvent&&n instanceof t.KeyboardEvent&&(o=_),r=e.pick(n,o),r.originalEvent=n,i=new e.DomEvent(r),g(i,n)},m=function(t,n){e.isArray(t)||(t=[t]);var i=n(t);i&&e.each(i,function(e,t){r[t]=e})},g=function(e,t){var n=t||e.originalEvent;return 3===n.target.nodeType&&(e.target=n.target.parentNode),e},b={init:function(){e.has(this,"currentType")&&delete this.currentType,this.isDefaultPrevented=!1,this.isPropagationStopped=!1,this.isImmediatePropagationStopped=!1},preventDefault:function(){this.isDefaultPrevented=!0;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=!0;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),this.cancelBubble=e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=!0,this.stopPropagation()}},E={};e.DomEvent=e.createClass(e.Event,b,E);var k={init:function(t){this.element=t,this.__wantEvent__=!1,t.__isEvented__=e.getUid(this),o.child(t).put("evented",this)},on:function(t,n,r){var o=e.bind(p,this);r=!i||r===!0,e.DomEvented.super_(this,"on",t,n,r),v(o,this.element,t,n,r)},off:function(t,n,i){var r=e.bind(d,this);t||(t=e.keys(this.__events__).join(" ")),e.DomEvented.super_(this,"off",t,n,i),v(r,this.element,t,n,i)},trigger:function(t){var i,r,o=a.call(arguments,1);e.isObject(t)&&t.type?(i=t,t=[i.type]):e.isString(t)&&(t=t.split(n)),e.each(t,function(t){var n;t&&(r=e.dom.parents(this.element,!0,!0),i&&void 0!=i.usecapture||e.each(r,function(n){if(n.__isEvented__&&!this.isPropagationStopped){var i,r=e.Evented.getObject(n.__isEvented__);r&&(i=new e.DomEvent({type:t,target:this.element,usecapture:!0}),e.DomEvented.super_.apply(null,[r,"trigger",t,i].concat(o)))}},this),(n=i)&&(n=new e.DomEvent({type:t,target:this.element,fired:!0})),e.DomEvented.super_.apply(null,[this,"trigger",t,n].concat(o)),i&&void 0!=i.usecapture||e.each(r.reverse(),function(n){if(n.__isEvented__){var i,r=e.Evented.getObject(n.__isEvented__);r&&(i=new e.DomEvent({type:t,target:this.element,usecapture:!1}),e.DomEvented.super_.apply(null,[r,"trigger",t,i].concat(o)))}},this))},this)}},x={};e.DomEvented=e.createClass(e.Evented,k,x);var w="contextmenu click dblclick mousedown mousemove mouseout mouseover mouseup mousewheel".split(" "),O="keydown keypress keyup".split(" ");m(["focusin","focusout"],function(t){var n={},i={focusin:"focus",focusout:"blur"};return e.support.focusin?void 0:(e.each(t,function(t){var r={};r.fix=function(e){return e.type=t,e},r.on=function(n,r,a,c){if(c===!1){var s=t+":false",u=o.child(n);u.has(s)||(u.put(s,function(t){var n=t.target,i=o.child(n),r=i.get(s+":stack");if(r)~e.indexOf(r,a)||r.unshift(a);else{var c=function(e){var t,a;for(t=0,a=r.length;a>t;t++)r[t].call(this,e);h(n,e.type,c,!1),i.remove(s+":stack"),0==i.length&&o.remove(n)};i.put(s+":stack",r=[a]),f(n,t.type,c,!1)}}),f(n,i[t],u.get(s),!0))}else f(n,i[t],a,!0)},r.off=function(e,n,r,a){if(a===!1){var c=t+":false",s=o.get(e);s&&s.get(c)&&h(e,i[t],s.get(c),!0)}else h(e,i[t],r,!0)},n[t]=r}),n)}),m(["mouseenter","mouseleave"],function(t){var n={},i={},r={mouseenter:"mouseover",mouseleave:"mouseout"};return e.support.mouseenter?void 0:(e.each(t,function(t){var o={};o.fix=function(e){return e.type=t,e},o.on=function(n,o,a,c){var s=t+":"+c,u=i[s];u||(u=function(t){var n=t.relatedTarget;this===n||e.dom.contains(this,n)||a.call(this,t)}),f(n,r[t],u,c)},o.off=function(e,n,o,a){var c=t+":"+a,s=i[c];s&&(i[c]=null,h(e,r[t],s,a))},n[t]=o}),n)}),m(w,function(t){{var n={},i=document;i.documentElement,i.body}return e.each(t,function(t){var i={};i.fix=function(n){{var i=n.originalEvent;i.target}return void 0===n.offsetX&&(n.offsetX=i.layerX,n.offsetY=i.layerY),e.support.firefox&&"mousewheel"==t&&("detail"in i&&(n.wheelDelta=40*-i.detail),n.type=t),n},e.support.firefox&&"mousewheel"==t&&(i.on=function(e,t,n,i){f(e,"DOMMouseScroll",n,i)},i.off=function(e,t,n,i){h(e,"DOMMouseScroll",n,i)}),n[t]=i}),n}),m(O,function(t){var n={};return e.each(t,function(e){var t={};t.fix=function(e){return("keyup"==e.type||"keydown"==e.type)&&(e.charCode=0),"keypress"==e.type&&(e.keyCode=e.keyCode||e.charCode,e.charCode=e.keyCode),e},n[e]=t}),n})}(),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.mace=e):t.mace=e}).call(this||window);